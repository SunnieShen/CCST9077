<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CHSH Game 模拟器（QuVis 风格参考）</title>
<link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header class="topbar">
    <div class="title">CHSH 游戏模拟 — QuVis 风格教学演示</div>
    <div class="subtitle">交互演示：经典 vs 量子策略 的胜率与 CHSH S 值</div>
  </header>

  <main class="layout">
    <aside class="controls card">
      <h2>控制面板</h2>

      <label>模拟策略</label>
      <select id="strategy">
        <option value="classical_best">经典最佳：a=b=0（理论 75%）</option>
        <option value="random">随机策略（独立随机）</option>
        <option value="quantum">量子最优（纠缠 + 最优测量）</option>
        <option value="custom">自定义确定性策略</option>
      </select>

      <div id="customPanel" class="panel hidden">
        <div class="sub">自定义输出（按输入 x 或 y）</div>
        <div class="two-col">
          <div>
            <div class="muted">Alice a(0), a(1)</div>
            <label><input type="radio" name="a0" value="0" checked> a(0)=0</label>
            <label><input type="radio" name="a0" value="1"> a(0)=1</label>
            <label><input type="radio" name="a1" value="0" checked> a(1)=0</label>
            <label><input type="radio" name="a1" value="1"> a(1)=1</label>
          </div>
          <div>
            <div class="muted">Bob b(0), b(1)</div>
            <label><input type="radio" name="b0" value="0" checked> b(0)=0</label>
            <label><input type="radio" name="b0" value="1"> b(0)=1</label>
            <label><input type="radio" name="b1" value="0" checked> b(1)=0</label>
            <label><input type="radio" name="b1" value="1"> b(1)=1</label>
          </div>
        </div>
      </div>

      <label>量子/测量角度（仅量子策略或自定义角度时生效）</label>
      <div class="muted small">角度以度为单位。默认为量子最优：A0=0°, A1=90°, B0=45°, B1=-45°</div>
      <div class="two-col">
        <div>
          <div class="muted">Alice θA(0)</div>
          <input id="a0angle" type="number" value="0" step="1">°
          <div class="muted">Alice θA(1)</div>
          <input id="a1angle" type="number" value="90" step="1">°
        </div>
        <div>
          <div class="muted">Bob θB(0)</div>
          <input id="b0angle" type="number" value="45" step="1">°
          <div class="muted">Bob θB(1)</div>
          <input id="b1angle" type="number" value="-45" step="1">°
        </div>
      </div>

      <label>回合数</label>
      <input id="trials" type="number" value="2000" min="1" max="1000000">

      <div class="row">
        <button id="runBtn" class="btn primary">运行</button>
        <button id="stepBtn" class="btn">单步</button>
        <button id="resetBtn" class="btn">复位</button>
      </div>

      <h3>统计</h3>
      <div class="stats-grid">
        <div class="stat">
          <div class="num" id="total">0</div>
          <div class="label">总回合</div>
        </div>
        <div class="stat">
          <div class="num" id="wins">0</div>
          <div class="label">胜利次数</div>
        </div>
        <div class="stat">
          <div class="num" id="winrate">—</div>
          <div class="label">胜率</div>
        </div>
        <div class="stat">
          <div class="num" id="Sval">—</div>
          <div class="label">CHSH S</div>
        </div>
      </div>

      <details class="info">
        <summary>按 (x,y) 分组统计</summary>
        <table class="smalltable">
          <thead><tr><th>(x,y)</th><th>次数</th><th>胜利</th><th>胜率</th></tr></thead>
          <tbody>
            <tr><td>(0,0)</td><td id="n00">0</td><td id="w00">0</td><td id="p00">—</td></tr>
            <tr><td>(0,1)</td><td id="n01">0</td><td id="w01">0</td><td id="p01">—</td></tr>
            <tr><td>(1,0)</td><td id="n10">0</td><td id="w10">0</td><td id="p10">—</td></tr>
            <tr><td>(1,1)</td><td id="n11">0</td><td id="w11">0</td><td id="p11">—</td></tr>
          </tbody>
        </table>
      </details>

      <p class="muted small">界面受 QuVis 教学页面布局启发，但代码与实现为独立原创。如需基于 QuVis 源码改编，请先联系原作者获取许可。</p>
    </aside>

    <section class="display card">
      <h2>可视化演示</h2>
      <div class="vis-row">
        <div class="station left">
          <div class="station-title">Alice</div>
          <div class="polarizer" id="alicePolar">
            <div class="angle-label" id="aliceAngleLabel">θA</div>
          </div>
        </div>

        <canvas id="animCanvas" width="680" height="240" class="canvas"></canvas>

        <div class="station right">
          <div class="station-title">Bob</div>
          <div class="polarizer" id="bobPolar">
            <div class="angle-label" id="bobAngleLabel">θB</div>
          </div>
        </div>
      </div>

      <div class="legend">
        <div class="muted">动画说明：每步生成一对纠缠光子（或经典样本），光子从中间出发被 Alice/Bob 测量。你可以单步观测或批量运行并查看统计。</div>
      </div>

      <h3>说明与教学提示</h3>
      <div class="muted">
        CHSH 胜利条件: a ⊕ b = x · y。局域实在论下最大平均胜率 0.75；量子纠缠在合适测量角度可以超越该界限（S = 2√2，胜率 ≈ 0.853553）。
      </div>
    </section>
  </main>

  <footer class="foot muted small">
    由学生项目实现（参考 QuVis 网页布局与教学风格）。如需导出 CSV / 英文版 / 打包为 GitHub Pages，请告诉我我可以继续生成。
  </footer>

<script src="js/core.js"></script>
<script src="js/ui.js"></script>
</body>
</html>